!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("vue")):"function"==typeof define&&define.amd?define(["exports","vue"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).loadmore={},e.vue)}(this,(function(e,t){"use strict";function i(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=i(t);function o(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];e.addEventListener(t,i,!!n&&{capture:!1,passive:n})}function s(e,t,i){e.removeEventListener(t,i)}var r={data:function(){return{direction:""}},methods:{bindTouchEvent:function(e){var t=this.onTouchStart,i=this.onTouchMove,n=this.onTouchEnd;o(e,"touchstart",t),o(e,"touchmove",i),n&&(o(e,"touchend",n),o(e,"touchcancel",n))},touchStart:function(e){this.resetTouchStatus(),this.startX=e.touches[0].clientX,this.startY=e.touches[0].clientY},touchMove:function(e){var t,i,n,o,s=e.touches[0];this.deltaX=s.clientX<0?0:s.clientX-this.startX,this.deltaY=s.clientY-this.startY,this.direction=this.direction||(t=this.deltaX,i=this.deltaY,n=Math.abs(t),o=Math.abs(i),n>o&&n>10?"horizontal":o>n&&o>10?"vertical":"")},resetTouchStatus:function(){this.direction="",this.deltaX=0,this.deltaY=0}}};var a={data:function(){return{timer:null}},methods:{timeout:function(e,t){clearTimeout(this.timer),setTimeout((function(){"function"==typeof e&&e()}),t)}},beforeDestroy:function(){clearTimeout(this.timer)}},l=/scroll|auto/i;function c(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window,i=e;i&&"HTML"!==i.tagName&&"BODY"!==i.tagName&&1===i.nodeType&&i!==t;){var n=window.getComputedStyle(i),o=n.overflowY;if(l.test(o))return i;i=i.parentNode}return t}var d={"zh-CN":{refresh:{pulling:"下拉刷新",loosing:"释放刷新",refresh:"正在刷新",success:"刷新完成"},loadmore:{loading:"正在加载",finished:"没有更多了",error:"请求失败，点击重新加载"}},"en-US":{refresh:{pulling:"Pull down to refresh",loosing:"Loosing to refresh",refresh:"Refreshing",success:"Refresh success"},loadmore:{loading:"Loading",finished:"No more data",error:"Request failed, click to reload"}}},u=n.default.prototype;(0,n.default.util.defineReactive)(u,"lang","zh-CN");var h={t:function(e){return function(e,t){var i=e;return t.split(".").forEach((function(e){var t;i=null!==(t=i[e])&&void 0!==t?t:""})),i}(d[u.lang],e)},use:function(e){d[e]&&(u.lang=e)}};var f=function(e,t,i,n,o,s,r,a,l,c){"boolean"!=typeof r&&(l=a,a=r,r=!1);var d,u="function"==typeof i?i.options:i;if(e&&e.render&&(u.render=e.render,u.staticRenderFns=e.staticRenderFns,u._compiled=!0,o&&(u.functional=!0)),n&&(u._scopeId=n),s?(d=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,l(e)),e&&e._registeredComponents&&e._registeredComponents.add(s)},u._ssrRegister=d):t&&(d=r?function(e){t.call(this,c(e,this.$root.$options.shadowRoot))}:function(e){t.call(this,a(e))}),d)if(u.functional){var h=u.render;u.render=function(e,t){return d.call(t),h(e,t)}}else{var f=u.beforeCreate;u.beforeCreate=f?[].concat(f,d):[d]}return i},v={name:"loading"},p=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"vuejs-loading vuejs-loading-circular"},[i("span",{staticClass:"vuejs-loading-spinner vuejs-loading-spinner-circular"},[i("svg",{staticClass:"vuejs-loading-circular",attrs:{viewBox:"25 25 50 50"}},[i("circle",{attrs:{cx:"50",cy:"50",r:"20",fill:"none"}})])]),e._v(" "),i("span",{staticClass:"vuejs-loading-text"},[e._t("default")],2)])};p._withStripped=!0;var g=f({render:p,staticRenderFns:[]},undefined,v,undefined,false,undefined,!1,void 0,void 0,void 0);function m(e,t){void 0===t&&(t={});var i=t.insertAt;if(e&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===i&&n.firstChild?n.insertBefore(o,n.firstChild):n.appendChild(o),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e))}}m(".vuejs-loading{color:#323233;font-size:0}.vuejs-loading,.vuejs-loading-spinner{position:relative;vertical-align:middle}.vuejs-loading-spinner{display:inline-block;height:20px;max-height:100%;max-width:100%;width:20px}.vuejs-loading-spinner-circular{-webkit-animation-duration:2s;animation-duration:2s}.vuejs-loading-circular{display:block;height:100%;width:100%}.vuejs-loading-circular circle{stroke:currentColor;stroke-width:3;stroke-linecap:round;-webkit-animation:vuejs-circular 1.5s ease-in-out infinite;animation:vuejs-circular 1.5s ease-in-out infinite}.vuejs-loading-text{color:#646566;display:inline-block;font-size:14px;margin-left:8px;vertical-align:middle}@-webkit-keyframes vuejs-circular{0%{stroke-dasharray:1,200;stroke-dashoffset:0}50%{stroke-dasharray:90,150;stroke-dashoffset:-40}to{stroke-dasharray:90,150;stroke-dashoffset:-120}}@keyframes vuejs-circular{0%{stroke-dasharray:1,200;stroke-dashoffset:0}50%{stroke-dasharray:90,150;stroke-dashoffset:-40}to{stroke-dasharray:90,150;stroke-dashoffset:-120}}");var y=["pulling","loosing","refresh","success"],k={name:"loadmore",mixins:[r,function(e){function t(){e.call(this,o)}function i(){e.call(this,s)}return{mounted:t,activated:t,deactivated:i,beforeDestroy:i}}((function(e){this.scroller||(this.scroller=c(this.$el)),e(this.scroller,"scroll",this.checkSroll)})),a],components:{Loading:g},props:{onRefresh:Function,pullingText:{type:String},loosingText:{type:String},refreshText:{type:String},successText:{type:String},showSuccessText:{type:Boolean,default:!0},pullDistance:{type:[Number,String],default:50},headHeight:{type:[Number,String],default:50},animationDuration:{type:[Number,String],default:200},onLoadmore:Function,immediateCheck:{type:Boolean,default:!1},loadOffset:{type:[Number,String],default:50},finished:Boolean,error:Boolean,loadingText:{type:String},finishedText:{type:String},errorText:{type:String}},data:function(){return{status:"normal",distance:0,duration:0,scroller:null,loadLoading:!1}},mounted:function(){this.bindTouchEvent(this.$refs.track),this.scroller=c(this.$el),this.immediateCheck&&this.checkSroll()},computed:{touchable:function(){return"refresh"!==this.status&&"success"!==this.status&&this.onRefresh},headStyle:function(){return 50!==this.headHeight?{height:"".concat(this.headHeight,"px")}:{}},genStatus:function(){var e=this.status,t=this["".concat(e,"Text")]||h.t("refresh.".concat(e));return-1!==y.indexOf(e)?t:""}},watch:{loadLoading:"checkSroll",finished:"checkSroll"},methods:{t:h.t,checkPullStart:function(e){var t,i;this.ceiling=0===(t=this.scroller,i="scrollTop"in t?t.scrollTop:t.pageYOffset,Math.max(i,0)),this.ceiling&&(this.duration=0,this.touchStart(e))},onTouchStart:function(e){this.touchable&&this.checkPullStart(e)},onTouchMove:function(e){this.touchable&&(this.ceiling||this.checkPullStart(e),this.touchMove(e),this.ceiling&&this.deltaY>=0&&"vertical"===this.direction&&(!function(e){("boolean"!=typeof e.cancelable||e.cancelable)&&e.preventDefault()}(e),this.setStatus(this.ease(this.deltaY))))},onTouchEnd:function(){var e=this;this.deltaY&&this.touchable&&(this.duration=this.animationDuration,"loosing"===this.status?(this.showRefreshTip(),this.$nextTick((function(){e.onRefresh(e.refreshDone)}))):this.setStatus(0))},ease:function(e){var t=+(this.pullDistance||this.headHeight);return e>t&&(e=e<2*t?t+(e-t)/2:1.5*t+(e-2*t)/4),Math.round(e)},setStatus:function(e){var t,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t=i?"refresh":0===e?"normal":e<(this.pullDistance||this.headHeight)?"pulling":"loosing",this.distance=e,t!==this.status&&(this.status=t)},refreshDone:function(){var e=this;this.showSuccessText?this.timeout(this.showSuccessTip,500):this.timeout((function(){return e.setStatus(0)}),500)},showRefreshTip:function(){this.setStatus(+this.headHeight,!0)},showSuccessTip:function(){var e=this;this.status="success",this.timeout((function(){return e.setStatus(0)}),1e3)},checkSroll:function(){var e=this;this.$nextTick((function(){if(!e.loadLoading&&e.onLoadmore&&!e.finished&&!e.error){var t,i=e.scroller,n=e.loadOffset;if(!((t=i.getBoundingClientRect?i.getBoundingClientRect():{top:0,bottom:i.innerHeight}).bottom-t.top))return!1;e.$refs.placeholder.getBoundingClientRect().bottom-t.bottom<=n&&(e.loadLoading=!0,e.timeout((function(){return e.onLoadmore(e.loadmoreDone)}),500))}}))},clickErrorText:function(){var e=this;this.$emit("update:error",!1),this.loadLoading=!0,this.timeout((function(){return e.onLoadmore(e.loadmoreDone)}),500)},loadmoreDone:function(){this.loadLoading=!1}}},x=k,b=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"vuejs-loadmore"},[i("div",{ref:"track",staticClass:"vuejs-refresh-track",style:{transform:e.distance?"translate3d(0, "+e.distance+"px, 0)":"",webkitTransform:e.distance?"translate3d(0, "+e.distance+"px, 0)":"",transitionDuration:e.duration+"ms"}},[i("div",{staticClass:"vuejs-refresh-head",style:e.headStyle},["refresh"===e.status?i("div",[i("Loading",[e._v(e._s(e.genStatus))])],1):i("div",{staticClass:"vuejs-refresh-text"},[e._v(e._s(e.genStatus))])]),e._v(" "),e._t("default"),e._v(" "),i("div",{staticClass:"vuejs-loadmore"},[!e.loadLoading||e.finished||e.error?e._e():i("div",{staticClass:"vuejs-loadmore-loading"},[i("Loading",[e._v(e._s(e.loadingText||e.t("loadmore.loading")))])],1),e._v(" "),e.finished?i("div",{staticClass:"vuejs-loadmore-finished-text"},[e._v("\n        "+e._s(e.finishedText||e.t("loadmore.finished"))+"\n      ")]):e._e(),e._v(" "),e.error?i("div",{staticClass:"vuejs-loadmore-error-text",on:{click:e.clickErrorText}},[e._v("\n        "+e._s(e.errorText||e.t("loadmore.error"))+"\n      ")]):e._e(),e._v(" "),i("div",{ref:"placeholder",staticClass:"vuejs-loadmore-placeholder"})])],2)])};b._withStripped=!0;var S=f({render:b,staticRenderFns:[]},undefined,x,undefined,false,undefined,!1,void 0,void 0,void 0);m(".vuejs-loadmore{overflow:hidden;-webkit-user-select:none;user-select:none}.vuejs-refresh-track{height:100%;position:relative;-webkit-transition-property:-webkit-transform;transition-property:-webkit-transform;transition-property:transform;transition-property:transform,-webkit-transform}.vuejs-refresh-head{-webkit-box-pack:center;-webkit-box-align:center;-webkit-align-items:center;align-items:center;color:#646566;display:-webkit-box;display:-webkit-flex;display:flex;font-size:14px;height:50px;-webkit-justify-content:center;justify-content:center;left:0;overflow:hidden;position:absolute;text-align:center;-webkit-transform:translateY(-100%);transform:translateY(-100%);width:100%}.vuejs-loadmore-error-text,.vuejs-loadmore-finished-text,.vuejs-loadmore-loading{color:#646566;font-size:14px;line-height:40px;text-align:center}.vuejs-loadmore-placeholder{height:0;pointer-events:none}");var T={install:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.component("vue-loadmore",S),h.use(t.lang)}};e.default=T,e.locale=h,Object.defineProperty(e,"__esModule",{value:!0})}));
